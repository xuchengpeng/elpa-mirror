This code has been tested some, but no doubt contains a zillion bugs.
You have been warned.
